services:
  master:
    image: lgfs:latest
    ports:
      - "2551:2551"
    environment:
      NODE_PORT: 2551
      HOST_NAME: 172.20.128.2
      NODE_ROLE: "master"
      CONF_PATH: "/app/conf/application.conf"
    networks:
      static-network:
        ipv4_address: 172.20.128.2
    volumes:
      - type: bind
        source: "./app/src/main/resources/application.conf"
        target: "/app/conf/application.conf"
    profiles: ["master","all"]

  chunk-1:
    image: lgfs:latest
    ports:
      - "2552:2552"
    networks:
      static-network:
        ipv4_address: 172.20.128.3
    environment:
      NODE_PORT: 2552
      HOST_NAME: 172.20.128.3
      CONF_PATH: "/app/conf/application.conf"
    volumes:
      - type: bind
        source: "./app/src/main/resources/chunk.conf"
        target: "/app/conf/application.conf"
    profiles: ["chunk","all"]

networks:
  static-network:
      ipam:
        config:
          - subnet: 172.20.0.0/16
            #docker-compose v3+ do not use ip_range